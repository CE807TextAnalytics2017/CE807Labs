"""
RUNNING TIMES OF IMPROVED:
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 14.4min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 14.3min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 57.1min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 56.0min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 27.2min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.5min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 18.1min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.9min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 13.0min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.6min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.4min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.1min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 25.6min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 17.5min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.3min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.3min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 49.7min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.3min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.6min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.7min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 18.9min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 15.2min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 15.4min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 57.3min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 55.1min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 27.5min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 27.2min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 18.6min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 13.1min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 13.1min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 52.1min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.7min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.2min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 25.8min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 17.6min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.5min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.4min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 49.6min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 49.5min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 25.2min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 24.8min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 17.1min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.7min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 12.7min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.7min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 52.5min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 28.6min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.9min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 18.2min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 13.2min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 13.3min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 52.8min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 51.4min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.1min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 25.6min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 17.4min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 11.7min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 11.6min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 46.5min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 46.4min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 23.5min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 23.1min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 15.8min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 11.7min finished
[Parallel(n_jobs=-1)]: Done  36 out of  36 | elapsed: 11.6min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 46.9min finished
[Parallel(n_jobs=-1)]: Done 144 out of 144 | elapsed: 47.6min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 24.3min finished
[Parallel(n_jobs=-1)]: Done  72 out of  72 | elapsed: 26.3min finished
[Parallel(n_jobs=-1)]: Done  48 out of  48 | elapsed: 18.7min finished
"""
import numpy as np
import scipy as sc

base = dict(np.load('../../base_res_old/baseline_confusion.npz')['arr_0'].item())
imp = dict(np.load('../../imp_old/single_feat_improved_confusion.npz')['arr_0'].item())
imp.pop('voted')
base.pop('voted')
Multimp = imp.pop('MultinomialNB')
Multimp = np.asarray(Multimp)

def W(x,y):return sc.stats.wilcoxon(x,y)[-1]/2
def KS(x,y):return sc.stats.ks_2samp(x,y)[-1]/2
def MW(x,y):return stats.mannwhitneyu(x,y,use_continuity=True, alternative='less')[-1]

print('Ammount of errors: classified (imp > base)')

for k in base:
    print(k,
    KS( np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten()),
    W(  np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten()),
    MW( np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten()))


print('Correctly classified (imp > base)')

for k in base:
    print(k,
    KS( np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten()),
    W(  np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten()),
    MW( np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten(),
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten()))
        

print('Ammount of errors: classified (imp > base)')

for k in base:
    print(k,'\n',
     np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten(),'\n',
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i!=j]).flatten())


print('Correctly classified (imp > base)')

for k in base:
    print(k,'\n',
     np.asarray([np.median(Multimp,0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten(),'\n',
        np.asarray([np.median(base[k],0)[i,j] for i in range(4) for j in range(4) if i==j]).flatten())